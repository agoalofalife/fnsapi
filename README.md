<h1 align="center">Fns API SOAP</h1>
<p align="center">
 <a href="https://scrutinizer-ci.com/g/agoalofalife/fnsapi/?branch=master"><img src="https://scrutinizer-ci.com/g/agoalofalife/fnsapi/badges/quality-score.png?b=master"></a>
 </p>

–ü–∞–∫–µ—Ç –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Ä–∞–±–æ—Ç—ã –ø–æ –ø—Ä–æ–≤–µ—Ä–∫–µ —á–µ–∫–æ–≤ —á–µ—Ä–µ–∑ [–æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–µ API](https://www.nalog.ru/files/kkt/pdf/%D0%A2%D0%B5%D1%85%D0%BD%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B8%D0%B5%20%D1%83%D1%81%D0%BB%D0%BE%D0%B2%D0%B8%D1%8F%20%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D1%8F.pdf) –§–ù–° (–§–µ–¥–µ—Ä–∞–ª—å–Ω–æ–π –ù–∞–ª–æ–≥–æ–≤–∞—è —Å–ª—É–∂–±—ã –†–æ—Å—Å–∏–∏).


- [–£—Å—Ç–∞–Ω–æ–≤–∫–∞](#Installation)
- [–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è](#auth)
- [–°–æ–∑–¥–∞—Ç—å Ticket (–∫–∞—Å—Å–æ–≤—ã–π —á–µ–∫)](#create_ticket)
- [–°–æ–∑–¥–∞–Ω–∏–µ SOAP Client](#create_soap_client)
- [–ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–ª–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –ø–æ —á–µ–∫—É](#check_or_info_ticket)
- [Response –≤ –≥–æ—Ç–æ–≤–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–µ](#response_in_strucutre)
- [–ê–ª–≥–æ—Ä–∏—Ç–º—ã –æ–±—Ä–∞–±–æ—Ç–∫–∏ timeout](#strategy_timout)
- [–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ—Ç –∞–≤—Ç–æ—Ä–∞](#note_from_author)
- [–£–≥–æ—Å—Ç–∏—Ç—å —á–∞–µ–º üòå](#donate)

<a name="Installation"></a>
## –£—Å—Ç–∞–Ω–æ–≤–∫–∞
`composer require agoalofalife/fnsapi`

<a name="auth"></a>

## –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
–î–ª—è –Ω–∞—á–∞–ª–∞ —Ä–∞–±–æ—Ç—ã —Å —Å–µ—Ä–≤–∏—Å–æ–º, –≤–∞–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–æ–ª—É—á–∏—Ç—å –≤—Ä–µ–º–µ–Ω–Ω—ã–π —Ç–æ–∫–µ–Ω.
–ù–∞ –º–æ–º–µ–Ω—Ç –Ω–∞–ø–∏—Å–∞–Ω–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏, –≤—Ä–µ–º—è –µ–≥–æ –∂–∏–∑–Ω–∏ –±—ã–ª –æ–¥–∏–Ω —á–∞—Å.

```php
$cachePSR16 = new Sarahman\SimpleCache\FileSystemCache(__DIR__);
$master_token = 'ourMasterToken';
$auth = new Fns\Auth\AuthRequest($master_token, $cachePSR16);
$auth->authenticate();
```

–í–∞–º –Ω–∞–¥–æ –ø–µ—Ä–µ–¥–∞—Ç—å –º–∞—Å—Ç–µ—Ä —Ç–æ–∫–µ–Ω, –∫–æ—Ç–æ—Ä—ã–π –≤—ã–¥–∞–ª–∏ –≤ –§–ù–° –∏  —Ö—Ä–∞–Ω–∏–ª–∏—â–µ, –∫–æ—Ç–æ—Ä–æ–µ —Ä–µ–∞–ª–∏–∑—É–µ—Ç PSR-16.

–í —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –±—É–¥–µ—Ç —Å–≤–æ–µ–≤—Ä–µ–º–µ–Ω–Ω–æ –æ–±–Ω–æ–≤–ª—è—Ç—å—Å—è –Ω–æ–≤—ã–π —Ç–æ–∫–µ–Ω,  [–∫–æ—Ç–æ—Ä—ã–π —Ä–µ–∞–ª–∏–∑—É–µ—Ç—Å—è –≤ PSR-16](https://github.com/php-fig/simple-cache/blob/master/src/CacheInterface.php#L34) –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º ttl.

PSR-16 –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–∞–∫–µ—Ç –≤–æ –º–Ω–æ–≥–∏—Ö —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∞—Ö –∏ —Ç.–¥

–ö–ª–∞—Å—Å –∏–º–µ–µ—Ç –∏—Å–∫–ª—é—á–µ–Ω–∏–µ UnexpectedValueException  –≤ —Å–ª—É—á–∞–µ –µ—Å–ª–∏ —Ç–æ–∫–µ–Ω –Ω–µ –±—É–¥–µ—Ç –ø–æ–ª—É—á–µ–Ω.

#### –í—Ä–µ–º–µ–Ω–Ω–∞—è –∑–æ–Ω–∞
–í—Ä–µ–º—è –∂–∏–∑–Ω–∏ —Ç–æ–∫–µ–Ω–∞ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –≤–∞—à–µ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–æ–π [PHP: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è - Manual](https://www.php.net/manual/ru/datetime.configuration.php#ini.date.timezone)
date.timezone
–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–∞—à —Ñ–∞–π–ª php.ini –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é –≤—Ä–µ–º–µ–Ω–Ω—É—é –∑–æ–Ω—É.

<a name="create_ticket"></a>
##  –°–æ–∑–¥–∞—Ç—å Ticket (–∫–∞—Å—Å–æ–≤—ã–π —á–µ–∫)
–î–ª—è —Ç–æ–≥–æ —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –ø–æ —á–µ–∫—É, –≤–∞–º –Ω–∞–¥–æ —Å–æ–∑–¥–∞—Ç—å –æ–±—ä–µ–∫—Ç –∫–ª–∞—Å—Å–∞ `Ticket`
–ü–æ–¥—Ä–æ–±–Ω–µ–µ –æ –¥–∞–Ω–Ω—ã—Ö –Ω–∞–ø–∏—Å–∞–Ω–æ –≤ –∫–æ–¥–µ –∏ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –§–ù–°.

```php
$ticket = new \Fns\Ticket();
$ticket->setDate('2019-12-16T12:22:00');
$ticket->setFiscalDocumentId(11222);
$ticket->setFiscalSign(111111122);
$ticket->setFn(1234000123440000);
$ticket->setSum(11220);
$ticket->setTypeOperation(1);
// —Å–ª—É—á–∞–π–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
```
<a name="create_soap_client"></a>
## –°–æ–∑–¥–∞–Ω–∏–µ SOAP Client
–û—Ç–ª–∏—á–Ω–æ –º—ã —Å–æ–∑–¥–∞–ª–∏ —á–µ–∫ –∏ –∑–∞–ø–æ–ª–Ω–∏–ª–∏ –µ–≥–æ –¥–∞–Ω–Ω—ã–º–∏. 
–¢–µ–ø–µ—Ä—å –Ω–∞–¥–æ —Å–æ–∑–¥–∞—Ç—å SOAP client.
–≠—Ç–æ –æ—á–µ–Ω—å –æ—Å–≤–µ–¥–æ–º–ª–µ–Ω–Ω—ã–π –∫–ª–∏–µ–Ω—Ç, –æ–Ω –∑–Ω–∞–µ—Ç —á—Ç–æ –º—ã —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –§–ù–°, –ø–æ—ç—Ç–æ–º—É –æ–Ω —Ç—Ä–µ–±—É–µ—Ç:
- –£–Ω–∏–∫–∞–ª—å–Ω—É—é —Å—Ç—Ä–æ–∫—É, –¥–ª—è —Å–µ—Å—Å–∏–∏. –≠—Ç–æ —Å—Ç—Ä–æ–∫–∞ –±—É–¥–µ—Ç –∫–æ–¥–∏—Ä–æ–≤–∞—Ç—å—Å—è  –≤ base64(–∫–æ—Ç–æ—Ä—ã–π –ø—Ä–∏–º–µ—Ä–Ω–æ –Ω–∞ 30% —É–≤–µ–ª–∏—á–∏–≤–∞—é—Ç –¥–ª–∏–Ω—É), –Ω–µ –¥–æ–ª–∂–Ω–∞ –ø—Ä–µ–≤—ã—à–∞—Ç—å 160 —Å–∏–º–≤–æ–ª–æ–≤.
- –ò —Ç–æ –∂–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –¥–∞–Ω–Ω—ã—Ö, PSR-16, —Ç–æ—Ç —Å–æ–∑–¥–∞–Ω–Ω—ã–π –æ–±—ä–µ–∫—Ç, –∫–æ—Ç–æ—Ä—ã–π –ø–µ—Ä–µ–¥–∞–≤–∞–ª—Å—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ —Ç–æ–∫–µ–Ω–∞.
- –í–∫–ª—é—á–∏—Ç—å —Ä–µ–∂–∏–º debug(–ø–æ-—É–º–æ–ª—á–∞–Ω–∏—é false), –º–æ–∂–Ω–æ –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –∑–∞–ø—Ä–æ—Å—ã —Å –ø–æ–º–æ—â—å—é —Ç–∞–∫–∏—Ö –º–µ—Ç–æ–¥–æ–≤ –∫–∞–∫ `__getLastRequest` –∏ —Ç–∞–∫ –¥–∞–ª–µ–µ.

```php
$client = new \Fns\ClientSoap('uniqueStringOrNumber', $cache);
```

<a name="check_or_info_ticket"></a>
## –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–ª–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –ø–æ —á–µ–∫—É
–û—Ç–ª–∏—á–Ω–æ, –≤—ã —Å–æ–∑–¥–∞–ª–∏ —á–µ–∫ –∏ –∫–ª–∏–µ–Ω—Ç–∞.
–ò —É–∂–µ –≤—Å–µ –≥–æ—Ç–æ–≤–æ –¥–ª—è —Ä–∞–±–æ—Ç—ã!
–û—Å—Ç–∞–ª–æ—Å—å —É–∂–µ –≤—ã–±—Ä–∞—Ç—å:
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á–µ–∫ `\Fns\GetMessage\CheckTicketRequest`
- –ü–æ–ª—É—á–∏—Ç—å –ø–æ –Ω–µ–º—É –ø–æ–¥—Ä–æ–±–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é `\Fns\GetMessage\GetTicketRequest`


```
–î–ª—è —Å–ø—Ä–∞–≤–∫–∏
API –§–ù–° —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ —á–µ—Ä–µ–∑ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—Å—Ç—å.
–î–ª—è –Ω–∞—á–∞–ª–∞ –≤–∞–º –Ω–∞–¥–æ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞–ø—Ä–æ—Å –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è `MessageId`
—Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –ø–æ —á–µ–∫—É –∏ —Ç–∏–ø–æ–º(–ø—Ä–æ–≤–µ—Ä–∫–∞ –∏–ª–∏ –ø–æ–ª–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –ø–æ —á–µ–∫—É)
–î–∞–ª–µ–µ –Ω–æ–≤—ã–º –∑–∞–ø—Ä–æ—Å–æ–º —Å  `MessageId` –ø–æ–ª—É—á–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é.

–ù—é–∞–Ω—Å –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ —Ç–æ–º, —á—Ç–æ –ø–æ—Å–ª–µ–¥—É—é—â–∏–π –∑–∞–ø—Ä–æ—Å, –∏–º–µ–µ—Ç –≤—Ä–µ–º—è –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è –∏ —Å–µ—Ç–µ–≤—ã–µ –∑–∞–¥–µ—Ä–∂–∫–∏.
–ö –ø—Ä–∏–º–µ—Ä—É –≤—ã –º–æ–∂–µ—Ç–µ –ø–æ–ª—É—á–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –ø–æ `MessageId` –≤ —Ç–µ—á–µ–Ω–∏–∏ 60 —Å–µ–∫—É–Ω–¥.
–î–ª—è —Å–≤–æ–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ timeout —á–∏—Ç–∞–π—Ç–µ –≤ —Ä–∞–∑–¥–µ–ª–µ  –ê–ª–≥–æ—Ä–∏—Ç–º—ã –æ–±—Ä–∞–±–æ—Ç–∫–∏ timeout
```

- —Å–æ–∑–¥–∞–Ω–∏–µ –æ–±—å–µ–∫—Ç–∞ —Å —Ç–∏–ø–æ–º –∑–∞–ø—Ä–æ—Å–∞
- –í–Ω–µ–¥—Ä–∏—Ç—å —Å–≤–æ—é —Å—Ç—Ä–∞—Ç–µ–≥–∏—é –æ–±—Ä–∞–±–æ—Ç–∫–∏ timeout —Ä–µ–∞–ª–∏–∑—É—é—â–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å  `Fns\Contracts\TimeoutStrategyHandler`

- –°–æ–∑–¥–∞—Ç—å –æ–±—ä–µ–∫—Ç `SendMessageRequest` –ø–µ—Ä–µ–¥–∞—Ç—å –∫–ª–∏–µ–Ω—Ç–∞ –∫–æ—Ç–æ—Ä–æ–≥–æ –º—ã —Å–æ–∑–¥–∞–ª–∏ —Ä–∞–Ω–µ–µ –∏ –æ–±—ä–µ–∫—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞.
- –ü–µ—Ä–µ–¥–∞—Ç—å —á–µ–∫
- –ò –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∑–∞–ø—Ä–æ—Å `execute` –∫–æ—Ç–æ—Ä—ã–π –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å `ResponseSendMessage`
- –ü–æ–ª—É—á–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –ø–æ –∑–∞–ø—Ä–æ—Å—É –∫–æ–¥ –∏ —Ç–µ–ª–æ –æ—Ç–≤–µ—Ç–∞.

```php
$message = new \Fns\GetMessage\GetTicketRequest();
$message->setTimeoutStrategy(new ExponentialBackoff($message));
// –º–æ–∂–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–≤–æ–µ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ time out
$message->setTimeoutStrategy(new ExponentialBackoff($message), 600000000);

$request = new SendMessageRequest($client, $message);
$request->setTicket($ticket);
$response = $request->execute();

if ($response->getCode() === 200) {
    dump(json_decode($response->getBody()));
    // –∏–ª–∏ –ø–æ–ª—É—á–∏—Ç—å –≤ –≤–∏–¥–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
    $response->getReceipt();
}
```

–û—Ç–≤–µ—Ç –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –≤ json –∏–ª–∏ –≤ –æ–±–µ–∫—Ç–µ Receipt.

<a name="response_in_strucutre"></a>
#### Response –≤ –≥–æ—Ç–æ–≤–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–µ
–û—Ç–≤–µ—Ç –ø–æ —á–µ–∫—É –º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –≤ –≤–∏–¥–µ –≥–æ—Ç–æ–≤–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã, –∫–æ—Ç–æ—Ä–∞—è —Å–æ–¥–µ—Ä–∂–∏—Ç:
- –ö–ª–∞—Å—Å Receipt
- –ö–ª–∞—Å—Å ProductCollection
- –ö–ª–∞—Å—Å Product 

–∏ —Ä–µ—à–∞–µ—Ç —Ç–∞–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã –∫–∞–∫:
- –ë–æ–ª–µ–µ —è–≤–Ω–æ–µ –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
- –ò–Ω–∫–∞–ø—Å—É–ª—è—Ü–∏—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –∏—Ö –¥–ª—è –±–æ–ª–µ–µ –ø—Ä–æ—Å—Ç–æ–π –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ –±–µ–∑–±–æ–ª–µ–∑–Ω–æ—Å—Ç–∏ –≤ –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–º –∫–æ–¥–µ.

 –Ω–æ –≤—ã –≤—Å–µ–≥–¥–∞ –º–æ–∂–µ—Ç–µ –ø–æ–ª—É—á–∏—Ç—å —Å—ã—Ä–æ–π –≤–∞—Ä–∏–∞–Ω—Ç.

####  –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ–∫–∞  CheckTicketRequest
–î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ —á—Ç–æ —á–µ–∫ –∫–æ—Ä—Ä–µ–∫—Ç–µ–Ω, –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–∞–≤–Ω–∏—Ç—å –∫–æ–¥ –æ—Ç–≤–µ—Ç–∞ —Å –∫–æ–¥–æ–º 200.

```
–ò–∑ —Å—Ç–∞—Ä–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
–µ—Å–ª–∏ 200, —Ç–æ "–û—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã"
–µ—Å–ª–∏ 400, —Ç–æ "–§–æ—Ä–º–∞—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–µ–Ω"
–µ—Å–ª–∏ 406, —Ç–æ "–î–∞–Ω–Ω—ã–µ –Ω–µ –ø—Ä–æ—à–ª–∏ –ø—Ä–æ–≤–µ—Ä–∫—É"
–µ—Å–ª–∏ 503, —Ç–æ "–°–µ—Ä–≤–∏—Å –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω".
```

#### –ü–æ–ª—É—á–µ–Ω–∏–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –ø–æ —á–µ–∫—É GetTicketRequest

```
–ò–∑ —Å—Ç–∞—Ä–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
–°–æ–¥–µ—Ä–∂–∏–º–æ–µ –§–î, –µ—Å–ª–∏ –∫–æ–¥ –≤–æ–∑–≤—Ä–∞—Ç–∞ —Ä–∞–≤–µ–Ω 200
–µ—Å–ª–∏ 400, —Ç–æ "–§–æ—Ä–º–∞—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–µ–Ω"
–µ—Å–ª–∏ 404, —Ç–æ "–ß–µ–∫ –Ω–µ –Ω–∞–π–¥–µ–Ω"
–µ—Å–ª–∏ 406, —Ç–æ "–î–∞–Ω–Ω—ã–µ –Ω–µ –ø—Ä–æ—à–ª–∏ –ø—Ä–æ–≤–µ—Ä–∫—É"
–µ—Å–ª–∏ 453, —Ç–æ "–ß–µ–∫ –Ω–µ–∫–∫–æ—Ä–µ–∫—Ç–µ–Ω".
```

```
–ò–∑ –Ω–æ–≤–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞ –æ–ø—ã—Ç–Ω—ã–º –ø—É—Ç–µ–º:
452 - –ó–∞–ø—Ä–æ—Å –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ñ–æ—Ä–º–∞—Ç—É hsm
454 - –û–±—Ä–∞—â–µ–Ω–∏–µ –∫ hsm –±—ã–ª–æ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–æ –∏ –ø–æ–ª—É—á–µ–Ω –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏
455 - –ù–µ –Ω–∞–π–¥–µ–Ω—ã –¥–∞–Ω–Ω—ã–µ –≤ —Å–µ—Ä–≤–∏—Å–µ –ø–æ–∏—Å–∫–∞ —á–µ–∫–∞
531 - "" (–ü—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –∫–æ–≥–¥–∞ –±—ã–ª–∏ –æ—Ç–ø—Ä–æ–∞–≤–ª–µ–Ω—ã –Ω–µ–∫–∫–æ—Ä–µ–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ)

528 - –§–∏—Å–∫–∞–ª—å–Ω—ã–π –ø—Ä–∏–∑–Ω–∞–∫ –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—Ä–æ–≤–µ—Ä–µ–Ω, –ø–æ—Å–∫–æ–ª—å–∫—É –≤ hsm –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–π –∫–ª—é—á
531 - "" (–ü—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –∫–æ–≥–¥–∞ –±—ã–ª–∏ –æ—Ç–ø—Ä–æ–∞–≤–ª–µ–Ω—ã –Ω–µ–∫–∫–æ—Ä–µ–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ)
```

```
–ü–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è API –ø–æ–∫–∞ –Ω–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω –∫–æ–Ω–µ—á–Ω—ã–π —Å–ø–∏—Å–æ–∫ –æ—Ç–≤–µ—Ç–æ–≤!
```

<a name="strategy_timout"></a>
## –ê–ª–≥–æ—Ä–∏—Ç–º—ã –æ–±—Ä–∞–±–æ—Ç–∫–∏ timeout
–ß—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –ø–æ —á–µ–∫—É, –Ω–∞–¥–æ —Å–¥–µ–ª–∞—Ç—å –∑–∞–ø—Ä–æ—Å `SendMessageRequest` c –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º `messageId`
–ü—Ä–∏ –ø–µ—Ä–≤–æ–º(–≤—Ç–æ—Ä—ã–º –∏ —Ç.–¥) –∑–∞–ø—Ä–æ—Å–µ, —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è `messageId`, –º–æ–∂–µ—Ç –æ—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –ø–æ —á–µ–∫—É.
–ü–æ-—É–º–æ–ª—á–∞–Ω–∏—é –≤ –ø–∞–∫–µ—Ç–µ —Ä–µ–∞–ª–∏–∑–æ–≤—ã–≤–∞–µ—Ç—Å—è [Exponential Backoff](https://ru.wikipedia.org/wiki/%D0%9D%D0%BE%D1%80%D0%BC%D0%B0%D0%BB%D1%8C%D0%BD%D0%BE%D0%B5_%D1%80%D0%B0%D1%81%D0%BF%D1%80%D0%B5%D0%B4%D0%B5%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5)

–í—ã –º–æ–∂–µ—Ç–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å–≤–æ–π –∞–ª–≥–æ—Ä–∏—Ç–º —Ä–µ–∞–ª–∏–∑—É—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å `Fns\Contracts\TimeoutStrategyHandler\TimeoutStrategyHandler`

–î–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—è –ø—Ä–æ—Ü–µ—Å—Å–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–∞ –∏ –µ–≥–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞, –ø–µ—Ä–µ–¥–∞–π—Ç–µ –≤ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä `Fns\Contracts\RequestsManager`

–î–ª—è –ø—Ä–∏–º–µ—Ä–∞ –≤—ã –º–æ–∂–µ—Ç–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å–≤–æ–π –∞–ª–≥–æ—Ä–∏—Ç–º `Interval`
–ö–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –æ–ø—Ä–∞—à–∏–≤–∞—Ç—å —Å–µ—Ä–≤–µ—Ä —á–µ—Ä–µ–∑ –∫–æ–Ω—Å—Ç–∞–Ω—Ç–Ω—ã–π –ø—Ä–æ–º–µ–∂—É—Ç–æ–∫ –≤—Ä–µ–º–µ–Ω–∏.

<a name="note_from_author"></a>
## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ—Ç –∞–≤—Ç–æ—Ä–∞
–í –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç –≤—Å–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤ —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–º —Ä–µ–∂–∏–º–µ.
 –ú–æ–∂–Ω–æ —Ä–∞–∑–¥–µ–ª–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å –ø–æ–ª—É—á–µ–Ω–∏—è `messageId` –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –ø–æ –Ω–µ–º—É, –Ω–∞ –¥–≤–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–∞.
–î–ª—è –Ω–∞—á–∞–ª—å–Ω–æ–π –≤–µ—Ä—Å–∏–∏ –ø–∞–∫–µ—Ç–∞, –ø–æ–∫–∞ –æ—Å—Ç–∞—ë—Ç—Å—è —Ç–∞–∫.

<a name="donate"></a>
##  –£–≥–æ—Å—Ç–∏—Ç—å —á–∞–µ–º üòå
–≠—Ç–æ—Ç –ø–∞–∫–µ—Ç –±—ã–ª —Å–æ–∑–¥–∞–Ω –¥–ª—è —ç–∫–æ–Ω–æ–º–∏–∏ –≤–∞—à–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞ –±–µ–∑–≤–æ–∑–º–µ–∑–¥–Ω–æ–π –æ—Å–Ω–æ–≤–µ.
–ù–∞–¥–µ—é—Å—å —É –º–µ–Ω—è –ø–æ–ª—É—á–∏–ª–æ—Å—å —ç—Ç–æ —Å–¥–µ–ª–∞—Ç—å –∏ —è –±—É–¥—É —Ä–∞–¥ –ª—é–±—ã–º —Ñ–æ—Ä–º–∞–º —Å–ø–∞—Å–∏–±–æ.
–ó–≤–µ–∑–¥–∞ –∏–ª–∏ —Å–∫—Ä–æ–º–Ω—ã–π –¥–æ–Ω–∞—Ç - –æ–∫–∞–∂—É—Ç –º–Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∫—É –∏ –≤–µ—Ä—É –≤ –ª—é–¥–µ–π.
https://money.yandex.ru/to/410019109036855
